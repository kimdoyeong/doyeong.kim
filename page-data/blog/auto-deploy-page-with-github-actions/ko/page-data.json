{"componentChunkName":"component---src-templates-blog-tsx","path":"/blog/auto-deploy-page-with-github-actions/ko/","result":{"data":{"markdownRemark":{"id":"c49bd4d1-5ad9-524a-9b63-461fa20be343","html":"<p>Github Actions는 Github 레포지토리에 연동해서 사용할 수 있는 워크플로우 자동화 시스템입니다. 특정 액션 (push, pull_request 등)이 실행되면, Action도 실행되어 빌드 명령어 한 번 치지 않고 빠르게 배포를 완료할 수 있습니다.</p>\n<p>오늘은 이 Github Actions를 가지고, Github Page를 자동 배포하는 방법을 작성하고자 합니다.</p>\n<h1>준비해야 할 것</h1>\n<ul>\n<li>개발된 블로그: 저는 <a href=\"https://www.gatsbyjs.org/\">Gatsby</a>로 블로그를 개발했습니다. 만약 빌드할 필요가 없는 웹사이트라면, 이 글의 내용을 따르실 필요가 없고, 그냥 <code class=\"language-text\">master</code> 브랜치에 push만 하시면 바로 보실 수 있습니다. (주의사항: 개발하고 있는 원본 소스는 <code class=\"language-text\">master</code> 브랜치가 아닌 다른 브랜치에 올려주세요. <a href=\"https://github.com/kimdoyeong/kimdoyeong.github.io\">제 레포지토리</a>에서 어떻게 하는지 확인하실 수 있습니다.)</li>\n<li>Github</li>\n<li>Git</li>\n<li><a href=\"https://github.com/settings/tokens\">Github Personal Access Token</a></li>\n</ul>\n<h1>작업</h1>\n<h2>Actions Workflow 작성하기</h2>\n<p><code class=\"language-text\">.github/workflows</code>에 <code class=\"language-text\">deploy.yml</code> 파일을 만들어주시고, 다음과 같이 적어주세요.</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy Project\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> dev\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">update</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@master\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Set up Node.js\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>node@master\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">node-version</span><span class=\"token punctuation\">:</span> 12.x\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Cache node_modules\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/cache@v1\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> node_modules\n          <span class=\"token key atrule\">key</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>runner.OS<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">-</span>build<span class=\"token punctuation\">-</span>$<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>hashFiles('**/yarn.lock')<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">restore-keys</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n            ${{ runner.OS }}-build-${{ runner.OS }}-</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Install dependencies\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> yarn install <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>prod <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>pure<span class=\"token punctuation\">-</span>lockfile\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Build\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> yarn run build\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">NODE_ENV</span><span class=\"token punctuation\">:</span> production\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> peaceiris/actions<span class=\"token punctuation\">-</span>gh<span class=\"token punctuation\">-</span>pages@v2.5.0\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">PERSONAL_TOKEN</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>secrets.GH_PAT<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">PUBLISH_BRANCH</span><span class=\"token punctuation\">:</span> master\n          <span class=\"token key atrule\">PUBLISH_DIR</span><span class=\"token punctuation\">:</span> ./public\n          <span class=\"token key atrule\">SCRIPT_MODE</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></code></pre></div>\n<p>아래 설명을 하나하나 보시고, 바꾸실 부분이 있다면 바꾸시면 됩니다.</p>\n<ul>\n<li><code class=\"language-text\">name</code>: Action의 이름입니다.</li>\n<li><code class=\"language-text\">on</code>: 해당 Action이 실행될 이벤트입니다. 저는 <code class=\"language-text\">dev</code> 브랜치가 push될 때 실행되도록 하였습니다. 다른 브랜치가 push될때도 이 액션을 실행하고 싶으시다면, <code class=\"language-text\">- dev</code> 밑에 그 브랜치의 이름을 추가해주세요.</li>\n<li>\n<p><code class=\"language-text\">jobs</code>: 실행될 명령어들입니다. 순차적으로 실행됩니다. 아래 <code class=\"language-text\">update</code>는 job id입니다.</p>\n<ul>\n<li><code class=\"language-text\">runs-on</code>: 해당 명령어들이 실행될 환경입니다. 저는 가장 최신 버전의 우분투에서 실행하도록 하였습니다.</li>\n<li><code class=\"language-text\">steps</code>: 명령어입니다. <code class=\"language-text\">uses</code>를 이용하여 이미 만들어진 Action을 사용할 수도 있고, <code class=\"language-text\">run</code>을 통해 명령어를 실행합니다.</li>\n</ul>\n</li>\n</ul>\n<p>해당 액션은 다음 워크플로우를 따릅니다.</p>\n<ul>\n<li><code class=\"language-text\">checkout</code>: <code class=\"language-text\">$GITHUB_WORKSPACE</code> 아래에 파일들을 checkout합니다.</li>\n<li><code class=\"language-text\">actions/setup-node@master</code>: node.js를 Set-up합니다.</li>\n<li><code class=\"language-text\">actions/cache@v1</code>: <code class=\"language-text\">node_modules</code> 폴더를 cache하여, 더 빠르게 Action을 실행할 수 있게 합니다.</li>\n<li><code class=\"language-text\">yarn install</code>을 실행해 종속성을 설치합니다.</li>\n<li><code class=\"language-text\">yarn run build</code>를 이용해 빌드합니다.</li>\n<li><code class=\"language-text\">peaceiris/actions-gh-pages@v2.5.0</code>을 이용해 master 브랜치에 빌드된 파일들을 옮깁니다. 이 때, <a href=\"https://github.com/settings/tokens\">Github Personal Access Token</a>이 필요합니다.</li>\n</ul>\n<p>저장하고, 일단은 커밋해둡니다.</p>\n<h2>레포지토리 설정하기</h2>\n<p><code class=\"language-text\">Settings</code> -> <code class=\"language-text\">Secrets</code>에 들어갑니다. <code class=\"language-text\">Add a new secret</code>을 클릭해 Name을 <code class=\"language-text\">GH_PAT</code>으로 하고, 아까 발급한 Personal Access Token 값을 <code class=\"language-text\">Value</code>에 넣고 Add Secret을 누릅니다.</p>\n<p><code class=\"language-text\">Secrets</code>에서는 엑세스 토큰과 같이 공개돼서는 안되는 민감한 정보들을 다루는 데에 사용합니다.</p>\n<h2>Push하고 확인하기</h2>\n<p>자, 이제 푸시하고 <code class=\"language-text\">Actions</code> 탭에서 액션이 제대로 실행되는지 확인해 봅시다.</p>\n<h1>마무리</h1>\n<p>글을 쓰는데는 잘 익숙해지지 않네요. 만약 틀린 내용이 있거나 질문이 있다면 <a href=\"mailto:hello@doyeong.dev\">hello@doyeong.dev</a>로 이메일 보내주세요.</p>","excerpt":"Github Actions는 Github 레포지토리에 연동해서 사용할 수 있는 워크플로우 자동화 시스템입니다. 특정 액션 (push, pull_request 등)이 실행되면, Action…","frontmatter":{"title":"Github Actions로 Github Page 자동 배포","description":"편하게 블로그를 운영해보자","date":"2020-04-24","image":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACZElEQVQozy1Su27UQBTdlg+g5gvgB+jpqBAVn5AuEhUdSkfHo6JDoqEjRAIqkFIA4ZGEQJQor92sd9fehz32PD32+HDGwdLVvbbnnnvO3DOwTQfTAEZKWN8ivjsGS9QMW/O/62BdgKs9cw1rHYwxsMbCOYcQAgCeszUGmg26BnQl2UhAT8A+IgAPBqJ2Aa33MFqjaa6afRxOgNpZVEUFsSohlcGgMh1KHSAdoGwHoQIqEwgeUBNwf+SwfeyxO/Jo2o5gARGyJbtgLToOi2w1a8WBA6E65BIomAvZ9pFLMmobvP1hcHujwM1HBW6sr7B9ZAlFppJyzy+g/x5D7B5i9fMXll93IBdLDGZFjWShMV9JUDWnANJEDsCTzRXubIyw/mqGWw9HeLo1Q/AKWlTQ8wXEyRmKg0OkWx8wfv0GxWSKwf50jO/jIX5PE+yMT7GXncL4ugd89i7BtXtfcPfxH1x/8A0v30+iWGip4aoKdrmESS6hsgwVa1mWGJxmOQ6SKXbHl9g8+YSPo8+8S90DTnOPtRdHuL/xG2vPjzAvm/576HiXjI6D7cke2c7JWkAJAkreh6DUuaDsQqEoDWpuOKOk4cUZFmmCWZJgmTFThWBTfBwXJIyHKgroPIdklmUVl2J7z0UrBA6uo3VEjSWtMBynOB/OMJmkmKULpJSmuVFSIwmFbFkSMIeiVM0rUCpuOZqQYF13FbGOvvP0m/VkQpWalpI6+q6hsZm1oPdWqFYCMvpXKYznFdKcPgxtT+8/4FV2voG0be9H5aIvW4hK0QUV6waV9hxQM2hqKlTGIS0ssrLGPyCbOqdKdV3DAAAAAElFTkSuQmCC","aspectRatio":1.9047619047619047,"src":"/static/1503767c2088ef89d668a8e269cbe7bb/ba299/thumbnail.png","srcSet":"/static/1503767c2088ef89d668a8e269cbe7bb/bc549/thumbnail.png 960w,\n/static/1503767c2088ef89d668a8e269cbe7bb/ba299/thumbnail.png 1200w","sizes":"(max-width: 1200px) 100vw, 1200px"}}}}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/blog/auto-deploy-page-with-github-actions/ko/"}}}