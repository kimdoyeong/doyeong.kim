<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.a3612aadece5a9af80e4.css">@import url(https://fonts.googleapis.com/css?family=Noto+Sans+KR|Roboto+Condensed&display=swap);body{margin:0;background:#1f1f1f;color:#fff;font-family:Roboto Condensed,Noto Sans KR,sans-serif}._content_article_ a{color:#85c2ff;text-decoration:none}._content_article_ .token{word-break:break-all;white-space:pre-wrap}._content_article_ .token.function,._content_article_ .token.number{color:#9ea3ff}._content_article_ .token.string{color:#9fff6b}._content_article_ pre{padding:2em;background:#0a0a0a;border-radius:5px}._content_article_ .token.keyword{color:#b56bff}._content_article_ .token.boolean{color:#faff6b}</style><meta name="generator" content="Gatsby 2.18.4"/><title data-react-helmet="true">Github Actions로 Github Page 자동 배포 - Doyeong.dev</title><meta data-react-helmet="true" name="description" content="편하게 블로그를 운영해보자"/><meta data-react-helmet="true" property="og:title" content="Github Actions로 Github Page 자동 배포"/><meta data-react-helmet="true" property="og:description" content="편하게 블로그를 운영해보자"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="@doyeongkim"/><meta data-react-helmet="true" name="twitter:title" content="Github Actions로 Github Page 자동 배포"/><meta data-react-helmet="true" name="twitter:description" content="편하게 블로그를 운영해보자"/><meta data-react-helmet="true" property="og:image" content="/static/1503767c2088ef89d668a8e269cbe7bb/ba299/thumbnail.png"/><style type="text/css">.gatsby-resp-image-image{width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;color:transparent;}</style><link rel="icon" href="/icons/icon-48x48.png?v=3a45cb24d8a8b213c99acc921d321f3f"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=3a45cb24d8a8b213c99acc921d321f3f"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=3a45cb24d8a8b213c99acc921d321f3f"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=3a45cb24d8a8b213c99acc921d321f3f"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=3a45cb24d8a8b213c99acc921d321f3f"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=3a45cb24d8a8b213c99acc921d321f3f"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=3a45cb24d8a8b213c99acc921d321f3f"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=3a45cb24d8a8b213c99acc921d321f3f"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=3a45cb24d8a8b213c99acc921d321f3f"/><style data-styled="bFiBYq hVPlqB IgCkS" data-styled-version="4.4.1">
/* sc-component-id: Button-sc-9lkmnn-0 */
.IgCkS{all:unset;opacity:1;padding:.5em 1em;border-radius:3px;box-shadow:2px 2px 5px -1px rgba(0,0,0,0.3);box-sizing:border-box;color:black !important;-webkit-text-fill-color:black;background:rgb(230,230,230);}
/* sc-component-id: blog__Wrap-sc-1h7x36p-0 */
.bFiBYq .contents{max-width:1280px;margin:0 auto;padding:2.5em;}
/* sc-component-id: blog__Banner-sc-1h7x36p-1 */
.hVPlqB{height:100vh;background:url(/static/1503767c2088ef89d668a8e269cbe7bb/ba299/thumbnail.png) no-repeat;background-size:cover;background-position:center;box-shadow:0 10px 5px -1px rgba(0,0,0,0.3);position:relative;} .hVPlqB > .topbar{position:absolute;top:24px;left:24px;} .hVPlqB > .topbar a{all:unset;cursor:pointer;} .hVPlqB > header.header{position:absolute;bottom:0;padding:3em;padding-bottom:10vh;z-index:3;margin-bottom:2rem;max-width:1280px;margin:0 auto;left:0;right:0;} .hVPlqB > header.header .title{font-size:3.5em;margin-top:0;margin-bottom:1rem;} @media (max-width:480px){.hVPlqB > header.header .title{font-size:3em;}} .hVPlqB > header.header .sub p{margin-top:0;color:#bababa;} .hVPlqB > header.header .sub p.date{margin:0;} .hVPlqB > .background{background:linear-gradient( to bottom,rgba(0,0,0,0) 10%,rgba(0,0,0,0.7) 70% );position:absolute;bottom:0;left:0;right:0;height:70vh;z-index:0;}</style><link as="script" rel="preload" href="/webpack-runtime-ec0b7119899d51cd2902.js"/><link as="script" rel="preload" href="/app-f38f83936b5ba00a8e9f.js"/><link as="script" rel="preload" href="/styles-2062fa5e3a11f3742554.js"/><link as="script" rel="preload" href="/commons-1edc0af9efc6ddd94f9d.js"/><link as="script" rel="preload" href="/component---src-templates-blog-tsx-09adb3f84d3133f7a032.js"/><link as="fetch" rel="preload" href="/page-data/blog/auto-deploy-page-with-github-actions/ko/page-data.json" crossorigin="anonymous"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div class="blog__Wrap-sc-1h7x36p-0 bFiBYq"><div class="blog__Banner-sc-1h7x36p-1 hVPlqB"><div class="topbar"><a href="/blog/list"><button class="Button-sc-9lkmnn-0 IgCkS">목록으로 가기</button></a></div><header class="header"><h1 class="title">Github Actions로 Github Page 자동 배포</h1><div class="sub"><p class="date">2020-04-24</p><p>편하게 블로그를 운영해보자</p></div></header><div class="background"></div></div><div class="contents"><article class="article _content_article_"><p>Github Actions는 Github 레포지토리에 연동해서 사용할 수 있는 워크플로우 자동화 시스템입니다. 특정 액션 (push, pull_request 등)이 실행되면, Action도 실행되어 빌드 명령어 한 번 치지 않고 빠르게 배포를 완료할 수 있습니다.</p>
<p>오늘은 이 Github Actions를 가지고, Github Page를 자동 배포하는 방법을 작성하고자 합니다.</p>
<h1>준비해야 할 것</h1>
<ul>
<li>개발된 블로그: 저는 <a href="https://www.gatsbyjs.org/">Gatsby</a>로 블로그를 개발했습니다. 만약 빌드할 필요가 없는 웹사이트라면, 이 글의 내용을 따르실 필요가 없고, 그냥 <code class="language-text">master</code> 브랜치에 push만 하시면 바로 보실 수 있습니다. (주의사항: 개발하고 있는 원본 소스는 <code class="language-text">master</code> 브랜치가 아닌 다른 브랜치에 올려주세요. <a href="https://github.com/kimdoyeong/kimdoyeong.github.io">제 레포지토리</a>에서 어떻게 하는지 확인하실 수 있습니다.)</li>
<li>Github</li>
<li>Git</li>
<li><a href="https://github.com/settings/tokens">Github Personal Access Token</a></li>
</ul>
<h1>작업</h1>
<h2>Actions Workflow 작성하기</h2>
<p><code class="language-text">.github/workflows</code>에 <code class="language-text">deploy.yml</code> 파일을 만들어주시고, 다음과 같이 적어주세요.</p>
<div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy Project
<span class="token key atrule">on</span><span class="token punctuation">:</span>
  <span class="token key atrule">push</span><span class="token punctuation">:</span>
    <span class="token key atrule">branches</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> dev
<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">update</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@master
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Set up Node.js
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/setup<span class="token punctuation">-</span>node@master
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">node-version</span><span class="token punctuation">:</span> 12.x
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Cache node_modules
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/cache@v1
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">path</span><span class="token punctuation">:</span> node_modules
          <span class="token key atrule">key</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span>runner.OS<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">-</span>build<span class="token punctuation">-</span>$<span class="token punctuation">{</span><span class="token punctuation">{</span>hashFiles('**/yarn.lock')<span class="token punctuation">}</span><span class="token punctuation">}</span>
          <span class="token key atrule">restore-keys</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
            ${{ runner.OS }}-build-${{ runner.OS }}-</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install dependencies
        <span class="token key atrule">run</span><span class="token punctuation">:</span> yarn install <span class="token punctuation">-</span><span class="token punctuation">-</span>prod <span class="token punctuation">-</span><span class="token punctuation">-</span>pure<span class="token punctuation">-</span>lockfile

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Build
        <span class="token key atrule">run</span><span class="token punctuation">:</span> yarn run build
        <span class="token key atrule">env</span><span class="token punctuation">:</span>
          <span class="token key atrule">NODE_ENV</span><span class="token punctuation">:</span> production
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> peaceiris/actions<span class="token punctuation">-</span>gh<span class="token punctuation">-</span>pages@v2.5.0
        <span class="token key atrule">env</span><span class="token punctuation">:</span>
          <span class="token key atrule">PERSONAL_TOKEN</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span>secrets.GH_PAT<span class="token punctuation">}</span><span class="token punctuation">}</span>
          <span class="token key atrule">PUBLISH_BRANCH</span><span class="token punctuation">:</span> master
          <span class="token key atrule">PUBLISH_DIR</span><span class="token punctuation">:</span> ./public
          <span class="token key atrule">SCRIPT_MODE</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></code></pre></div>
<p>아래 설명을 하나하나 보시고, 바꾸실 부분이 있다면 바꾸시면 됩니다.</p>
<ul>
<li><code class="language-text">name</code>: Action의 이름입니다.</li>
<li><code class="language-text">on</code>: 해당 Action이 실행될 이벤트입니다. 저는 <code class="language-text">dev</code> 브랜치가 push될 때 실행되도록 하였습니다. 다른 브랜치가 push될때도 이 액션을 실행하고 싶으시다면, <code class="language-text">- dev</code> 밑에 그 브랜치의 이름을 추가해주세요.</li>
<li>
<p><code class="language-text">jobs</code>: 실행될 명령어들입니다. 순차적으로 실행됩니다. 아래 <code class="language-text">update</code>는 job id입니다.</p>
<ul>
<li><code class="language-text">runs-on</code>: 해당 명령어들이 실행될 환경입니다. 저는 가장 최신 버전의 우분투에서 실행하도록 하였습니다.</li>
<li><code class="language-text">steps</code>: 명령어입니다. <code class="language-text">uses</code>를 이용하여 이미 만들어진 Action을 사용할 수도 있고, <code class="language-text">run</code>을 통해 명령어를 실행합니다.</li>
</ul>
</li>
</ul>
<p>해당 액션은 다음 워크플로우를 따릅니다.</p>
<ul>
<li><code class="language-text">checkout</code>: <code class="language-text">$GITHUB_WORKSPACE</code> 아래에 파일들을 checkout합니다.</li>
<li><code class="language-text">actions/setup-node@master</code>: node.js를 Set-up합니다.</li>
<li><code class="language-text">actions/cache@v1</code>: <code class="language-text">node_modules</code> 폴더를 cache하여, 더 빠르게 Action을 실행할 수 있게 합니다.</li>
<li><code class="language-text">yarn install</code>을 실행해 종속성을 설치합니다.</li>
<li><code class="language-text">yarn run build</code>를 이용해 빌드합니다.</li>
<li><code class="language-text">peaceiris/actions-gh-pages@v2.5.0</code>을 이용해 master 브랜치에 빌드된 파일들을 옮깁니다. 이 때, <a href="https://github.com/settings/tokens">Github Personal Access Token</a>이 필요합니다.</li>
</ul>
<p>저장하고, 일단은 커밋해둡니다.</p>
<h2>레포지토리 설정하기</h2>
<p><code class="language-text">Settings</code> -> <code class="language-text">Secrets</code>에 들어갑니다. <code class="language-text">Add a new secret</code>을 클릭해 Name을 <code class="language-text">GH_PAT</code>으로 하고, 아까 발급한 Personal Access Token 값을 <code class="language-text">Value</code>에 넣고 Add Secret을 누릅니다.</p>
<p><code class="language-text">Secrets</code>에서는 엑세스 토큰과 같이 공개돼서는 안되는 민감한 정보들을 다루는 데에 사용합니다.</p>
<h2>Push하고 확인하기</h2>
<p>자, 이제 푸시하고 <code class="language-text">Actions</code> 탭에서 액션이 제대로 실행되는지 확인해 봅시다.</p>
<h1>마무리</h1>
<p>글을 쓰는데는 잘 익숙해지지 않네요. 만약 틀린 내용이 있거나 질문이 있다면 <a href="mailto:hello@doyeong.dev">hello@doyeong.dev</a>로 이메일 보내주세요.</p></article></div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/auto-deploy-page-with-github-actions/ko/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-f38f83936b5ba00a8e9f.js"],"component---src-templates-blog-tsx":["/component---src-templates-blog-tsx-09adb3f84d3133f7a032.js"],"component---src-templates-portfolio-tsx":["/component---src-templates-portfolio-tsx-f71fb854b9511dd27ce1.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-836d3c1d6d60589806ad.js"],"component---src-pages-blog-list-tsx":["/component---src-pages-blog-list-tsx-8d1705709e8b5de021e4.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-af7a4f96cf4a6fcbafff.js"]};/*]]>*/</script><script src="/component---src-templates-blog-tsx-09adb3f84d3133f7a032.js" async=""></script><script src="/commons-1edc0af9efc6ddd94f9d.js" async=""></script><script src="/styles-2062fa5e3a11f3742554.js" async=""></script><script src="/app-f38f83936b5ba00a8e9f.js" async=""></script><script src="/webpack-runtime-ec0b7119899d51cd2902.js" async=""></script></body></html>